{% extends "reports/base.html" %}
{% block content %}
{% load media_path %}

<!-- ================= COVER PAGE ================= -->
<div class="cover-page">

  <!-- Logo -->
  <div class="cover-logo">
    <div class="cover-icon"></div>
    <p>COMPANY LOGO</p>
  </div>

  <!-- Title -->
  <h1 class="cover-title">
    Vulnerability Assessment &<br>
    Penetration Testing Report
  </h1>

  <div class="cover-line"></div>

  <!-- Info -->
  <div class="cover-info">
    <div><span>Client :</span><span class="cover-value">{{ report.client_name }}</span></div>
    <div><span>Application :</span><span class="cover-value">{{ report.application_name }}</span></div>
    <div><span>Target :</span><span class="cover-value">{{report.target}}</span></div>
    <div><span>Prepared by :</span><span class="cover-value">{{report.created_by}}</span></div>
    <div><span>Date :</span><span class="cover-value">{{ report.created_at}}</span></div>
    
  </div>

  <!-- Corner -->
  <div class="cover-corner"></div>

  <!-- Footer -->
  <div class="cover-footer">
    CONFIDENTIAL
  </div>

</div>

<div class="page-break"></div>



<!-- ================= TABLE OF CONTENTS ================= -->

<h2>Table of Contents</h2>

<table class="toc-table">
  <tr>
    <td><a href="#disclaimer">1. Disclaimer</a></td>
    <td class="toc-page" href="#disclaimer"></td>
  </tr>
  <tr>
    <td><a href="#executive-summary">2. Executive Summary</a></td>
    <td class="toc-page" href="#executive-summary"></td>
  </tr>
  <tr>
    <td><a href="#findings">3. Detailed Findings</a></td>
    <td class="toc-page" href="#findings"></td>
  </tr>
  <tr>
    <td><a href="#action-plan">4. Action Plan</a></td>
    <td class="toc-page" href="#action-plan"></td>
  </tr>
  <tr>
    <td><a href="#conclusion">5. Conclusion</a></td>
    <td class="toc-page" href="#conclusion"></td>
  </tr>
</table>

<div class="page-break"></div>

<!-- ================= DISCLAIMER PAGE  ================= -->

<h2 id="disclaimer">1. Disclaimer</h2>

<p>
This report has been prepared exclusively for
<strong>{{ report.client_name }}</strong> and is intended solely for the purpose
of documenting the findings of the security assessment conducted on
<strong>{{ report.application_name }}</strong>.
</p>

<p>
The assessment was performed based on information and access provided at the
time of testing. The findings documented in this report represent a snapshot
of the application’s security posture during the assessment period.
</p>

<p>
No guarantee is provided that all security vulnerabilities have been identified.
The presence of vulnerabilities depends on many factors, including system
configuration changes, third‑party integrations, and updates performed after
the assessment.
</p>

<p>
This report contains confidential information and must not be disclosed,
reproduced, or distributed to any third party without prior written consent
from <strong>{{ report.client_name }}</strong>.
</p>

<div class="page-break"></div>

<!-- ================= EXECUTIVE SUMMARY ================= -->
<h2 id="executive-summary">2. Executive Summary</h2>

<p>
Web application vulnerability assessment and penetration testing was conducted
for <strong>{{ report.client_name }}</strong> on the application
<strong>{{ report.application_name }}</strong>.
</p>

<table class="summary-table executive-table">
  <thead>
    <tr>
      <th>Severity</th>
      <th>Count</th>
      <th>Risk Level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="sev-text critical">Critical</td>
      <td>{{ summary.severity.critical }}</td>
      <td>Immediate remediation required</td>
    </tr>

    <tr>
      <td class="sev-text high">High</td>
      <td>{{ summary.severity.high }}</td>
      <td>High risk to application security</td>
    </tr>

    <tr>
      <td class="sev-text medium">Medium</td>
      <td>{{ summary.severity.medium }}</td>
      <td>Moderate security concern</td>
    </tr>

    <tr>
      <td class="sev-text low">Low</td>
      <td>{{ summary.severity.low }}</td>
      <td>Low impact, best‑practice fixes</td>
    </tr>
  </tbody>
</table>

<br></br>

<!-- ================= DETAILED FINDINGS ================= -->

<!-- <div class="finding-block"> -->
<h2 id="findings">3. Detailed Findings</h2>

{% for f in findings %}

    {% if not forloop.first %}
        <div class="page-break"></div>
    {% endif %}

    <table class="finding-table">
        <tr>
            <td class="label-cell">Vulnerability {{ forloop.counter }}</td>
            <td class="value-cell"><strong>{{ f.final_title }}</strong></td>
        </tr>

        <tr>
            <td class="label-cell">Severity</td>
            <td class="
                {% if f.final_severity == 'CRITICAL' %}severity-critical
                {% elif f.final_severity == 'HIGH' %}severity-high
                {% elif f.final_severity == 'MEDIUM' %}severity-medium
                {% else %}severity-low{% endif %}
            ">
                {{ f.final_severity }}
            </td>
        </tr>

        <tr>
            <td class="label-cell">Description</td>
            <td class="value-cell">{{ f.final_description|linebreaks }}</td>
        </tr>

        <tr>
            <td class="label-cell">Implication</td>
            <td class="value-cell">{{ f.final_impact|linebreaks }}</td>
        </tr>

        <tr>
            <td class="label-cell">Recommendation</td>
            <td class="value-cell">{{ f.final_remediation|linebreaks }}</td>
        </tr>
    </table>

    {% if f.evidences.all %}
    <div class="evidence-section">
        <h4 class="evidence-heading">Evidence</h4>

        {% for e in f.evidences.all %}
        <div class="evidence-item">
            <p class="evidence-title"><strong>{{ e.title }}</strong></p>

            {% if e.file %}
                {% if is_pdf %}
                    <img src="{{ e.file.path|file_uri }}" class="evidence-image">
                {% else %}
                    <img src="{{ MEDIA_URL }}{{ e.file.name }}" class="evidence-image">
                {% endif %}
            {% endif %}

            {% if e.description %}
                <p class="evidence-desc">{{ e.description }}</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

{% endfor %}

</div>
<div class="page-break"></div>

<!-- ================= ACTION PLAN ================= -->

<h2 id="action-plan">4. Action Plan</h2>

<p>
During the assessment of the <strong>{{ report.application_name }}</strong>
application, the following security issues were identified:
{% if action_plan.severity_count.CRITICAL %}
<strong>{{ action_plan.severity_count.CRITICAL }} Critical</strong>,
{% endif %}
{% if action_plan.severity_count.HIGH %}
<strong>{{ action_plan.severity_count.HIGH }} High</strong>,
{% endif %}
{% if action_plan.severity_count.MEDIUM %}
<strong>{{ action_plan.severity_count.MEDIUM }} Medium</strong>
{% endif %}
severity vulnerabilities.
</p>

<p>
It is recommended that these issues be addressed on a priority basis to
reduce the risk of potential exploitation and improve the overall security
posture of the application.
</p>

<p><strong>Recommended remediation actions include:</strong></p>

<ul class="action-plan-list">
  {% for f in findings %}
    {% if f.final_remediation %}
      <li>
        <strong>{{ f.final_title }}</strong> — {{ f.final_remediation }}
      </li>
    {% endif %}
  {% endfor %}
</ul>


{% if action_plan.severity_count.LOW %}
{% endif %}

<div class="page-break"></div>

<!-- ================= CONCLUSION ================= -->

<h2 id="conclusion">Conclusion</h2>

<p>
The vulnerability assessment conducted for
<strong>{{ report.client_name }}</strong> on the application
<strong>{{ report.application_name }}</strong> identified multiple security
weaknesses of varying severity levels.
</p>

<p>
Critical and high‑severity vulnerabilities pose a significant risk and should be
addressed on a priority basis to reduce the likelihood of exploitation.
Medium and low‑severity issues, while less critical, should also be remediated
to strengthen the overall security posture of the application.
</p>

<p>
Implementing the recommended remediation measures outlined in this report will
help improve the application’s resilience against common attack vectors and
reduce exposure to potential threats.
</p>

<p>
Regular security assessments, secure coding practices, and continuous monitoring
are strongly recommended to maintain an acceptable security baseline and ensure
ongoing protection.
</p>

{% endblock %}